<extend name="Public/base" />
<block name="body">
	<!-- 标题栏 -->
	<div class="main-title">
		<h2>用户组管理</h2>
		<div class="tools auth-botton">
            <a id="add-group" class="btn" href="{:U('createGroup')}">
            	<i class="icon-add"></i><em>添加</em>
            </a>
            <button url="{:U('changestatus',array('method'=>'resumeGroup'))}" id="enable-group" class="btn">
            	<i class="icon-add"></i><em>启用</em>
            </button>
            <button url="{:U('changestatus',array('method'=>'forbidGroup'))}" id="disable-group" class="btn">
            	<i class="icon-denied"></i><em>禁用</em>
            </button>
            <button url="{:U('changestatus',array('method'=>'deleteGroup'))}" id="delete-group" class="btn">
            	<i class="icon-delete"></i><em>删除</em>
            </button>
		</div>
	</div>

	<!-- 数据列表 -->
	<div class="data-table">
		<table>
			<thead>
				<tr>
					<th class="row-selected"><input class="check-all" type="checkbox"/></th>
					<th>用户组</th>
					<th>描述</th>
					<th>状态</th>
					<th>操作</th>
					<th>授权</th>
				</tr>
			</thead>
			<tbody>
				<volist name="list" id="vo">
				<tr>
                    <td><input class="ids" type="checkbox" name="id[]" value="{$vo.id}" /></td>
					<td>{$vo.title}</td>
					<td>{$vo.description}</td>
					<td>{$vo.status_text}</td>
					<td>
						<a href="{:U('editGroup',array('id'=>$vo['id']))}">编辑</a>
                        <egt name="vo.status" value="0">
							<eq name="vo.status" value="0">
								<a href="{:U('changeStatus',array('id'=>$vo['id'],'method'=>'resumeGroup'))}">启用</a>
							<else />
								<a href="{:U('changeStatus',array('id'=>$vo['id'],'method'=>'forbidGroup'))}">禁用</a>
							</eq>
                        </egt> 
                        <a class="confirm" href="{:U('changeStatus',array('id'=>$vo['id'],'method'=>'deleteGroup'))}">删除</a>
					</td>
                    <td>
                        <a href="{:U('user',array('group_id'=>$vo['id'],'group_name'=>$vo['title']))}">成员</a>
                        <!-- <a href="{:U('category')}">栏目</a> -->
                    </td>
				</tr>
				</volist>
			</tbody>
		</table>
	</div>
</block>
<block name="script">
<script type="text/javascript">
    +function($){
        $('.confirm').on('click',function(){
            if(!confirm('确认要删除吗?')){
                return false;
            }
        });
        $('.auth-botton').find('button').on('click',function(){
            if( this.id=='delete-group' && !confirm('确认要删除吗?')){
                return false;
            }
            var url = $(this).attr('url');
            var ids = $('.ids').serialize();
            if (!ids) {
                //TODO: 错误提示
               	return false;
                // console.warn('没有选择内容')
            }
            $.post(url,ids).success(function(data){
                location.reload();
            }).error(function(data){
                //TODO: 错误提示
                return false;
                // console.error(data);
            });
        });
        //全选节点
        $('.check-all').on('change',function(){
            $('.ids').prop('checked',this.checked);
        });
    }(jQuery)
</script>
</block>
