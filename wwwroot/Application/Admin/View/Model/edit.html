<extend name="Public/base" />

<block name="body">
<div class="main-title cf">
<h2>新增模型</h2>
</div>
<div class="thinkbox-content">
	<!-- 表单 -->
	<form id="form" action="{:U('update')}" method="post" class="form-horizontal doc-modal-form">
		<div class="form-item cf">
			<label class="item-label">文档模型标识：</label>
			<div class="controls">
				<input type="text" class="text" name="name" value="{$name}">
				<span class="check-tips">请输入文档模型标识</span>
			</div>
		</div>
		<div class="form-item cf">
			<label class="item-label">标题：</label>
			<div class="controls">
				<input type="text" class="text" name="title" value="{$title}">
				<span class="check-tips">请输入标题</span>
			</div>
		</div>

		<div class="form-item cf">
			<label class="item-label"></label>
			<div class="controls">
				<input type="hidden" name="id" value="{$id}"/>
				<button class="btn ajax-post" type="submit" target-form="form-horizontal">确定</button>
			</div>
		</div>
	</form>
</div>
</block>

<block name="script">
<script type="text/javascript">
//ajax post submit请求
$('.ajax-post').click(function(){
    var target,query,form;
    var target_form = $(this).attr('target-form');
    if( (this.type=='submit') || (target = $(this).attr('href')) || (target = $(this).attr('url')) ){
        form = $('.'+target_form);
        if ( form.get(0).nodeName=='FORM' ){
            target = form.get(0).action;
            query = form.serialize();
        }else if( form.get(0).nodeName=='INPUT' || form.get(0).nodeName=='SELECT' || form.get(0).nodeName=='TEXTAREA') {
            query = form.serialize();
        }else{
            query = form.find('input,select,textarea').serialize();
        }
        $.post(target,query).success(function(data){
	        if (data.status==1) {
		        if (data.url) {
			        updateAlert(data.info + ' 页面即将自动跳转~','alert-success');
		        }else{
			        updateAlert(data.info + ' 页面即将自动刷新~','alert-success');
		        }
		        setTimeout(function(){
			        if (data.url) {
				        location.href=data.url;
			        }
			        location.reload();
		        },1500);
	        }else{
		        updateAlert(data.info);
	        }
        });
    }
    return false;
});
</script>
</block>