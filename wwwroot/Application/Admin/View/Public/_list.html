<?php if(!empty($_thead)) { ?>
<table class="data-table">
    <thead>
        <tr>
        <foreach name="_thead" item="th" key="key">
        <th>
            <if condition="!is_array($th)">
            {$th}
            <elseif condition="isset($th['title'])" />
            {$th.title}
            <?php
            if (!isset($th['tag'])){
                $_thead[$key]['tag'] = 'span';
            }
            ?>
            <else />
            {$key} 
            </if>
        </th>   
        </foreach>
        </tr>
    </thead>
    <?php if(!empty($_list)) { ?>
    <tbody>
        <?php foreach ($_list as $row) { ?>
        <tr>
            <?php foreach ($row as $key=>$td) {    
                  if(array_key_exists($key,$_thead)){ ?>
            <td>
                <?php 
                if( is_array($_thead[$key]) ) { 
                    $Doc = new DOMDocument('1.0','utf-8');
                    $ele = $Doc->createElement($_thead[$key]['tag'],$td);
                    foreach ($_thead[$key] as $k=>$v) {
                        if(strtolower($k)!='title' && strtolower($k)!='tag' ){
                            $v = preg_replace_callback('/\$(\w+)/',function($matches) use($row) {
                                return ($row[$matches[1]]);
                            },$v);
                            $ele->setAttribute($k,$v);
                        }
                    }
                    $Doc->appendChild($ele);
                    echo $Doc->saveHTML();
                }else{
                   echo $td;
                }
               ?>
            </td>
            <?php }   
                  } ?>
        </tr>
        <?php } ?>
    </tbody>
    <?php } ?>
</table>
<?php } ?>
