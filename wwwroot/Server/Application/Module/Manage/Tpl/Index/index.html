<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title>用户管理中心 - 首页</title>
	<link rel="stylesheet" type="text/css" href="__PUBLIC__/style.css" media="all">
</head>
<body>
	<!-- 头部 -->
	<div class="header">
		<!-- Logo -->
		<a href="javascript:;" class="logo"></a>
		<!-- /Logo -->
		
		<!-- 主导航 -->
		<ul class="main-nav">
			<li><a href="javascript:;">系统概况</a></li>
			<li class="current"><a href="javascript:;">数据管理</a></li>
			<li><a href="javascript:;">相关设置</a></li>
		</ul>
		<!-- /主导航 -->
	</div>
	<!-- /头部 -->

	<!-- 主体 -->
	<div class="wrapper cf">
		<!-- 边栏 -->
		<div class="sidebar">
			<!-- 子导航 -->
			<div class="subnav">
				<!-- 子导航-1 -->
				<h3><i class="icon-s1"></i>数据管理</h3>
				<ul>
					<li class="current"><a href="{:U('Member/index')}">用户管理</a></li>
					<li><a href="{:U('App/index')}">应用管理</a></li>
				</ul>
				<!-- /子导航-1 -->
				<!-- 子导航-2 -->
				<h3><i class="icon-s2"></i>数据库管理</h3>
				<ul>
					<li><a href="{:U('Database/index')}">备份数据库</a></li>
					<li><a href="javascript:;">还原数据库</a></li>
					<li><a href="javascript:;">更新数据缓存</a></li>
				</ul>
				<!-- /子导航-2 -->
			</div>
			<!-- /子导航 -->
		</div>
		<!-- /边栏 -->
		
		<!-- 内容区 -->
		<div id="main" class="main"></div>
		<!-- /内容区 -->
	</div>
	<!-- wrapper 主体 -->
	<script type="text/javascript" src="__PUBLIC__/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="__PUBLIC__/thinkbox/jquery.thinkbox.min.js"></script>
	<script type="text/javascript">
		//加载内容
		var loading, $main = $("#main");
		$.thinkbox.defaults("style", "ta");
		$main.bind("loader", function(e, element){
			loading = $.thinkbox.loading("数据加载中...");
			$main.load(element.href, function(){
				loading.hide();
			});
		});

		//导航切换
		$(".subnav").on("click", "a", function(e){
			var self = $(this);
			self.closest(".subnav").find(".current").removeClass("current");
			self.parent().addClass("current");
			$main.trigger("loader", this);
			return false;
		});
		$(".subnav .current a").click();

		//编辑数据
		$main.on("click", ".action .edit", function(){
			$main.trigger("loader", this);
			return false;
		});

		//禁用数据
		$main.on("click", ".action .status", function(){
			var self = $(this), text = this.innerHTML, status = Math.abs(self.data("status")-1);
			$.thinkbox.confirm("你确定要" + text + "该数据？", {
				"afterHide" : function(isok){
					if(isok){
						loading = $.thinkbox.loading("加载中...");
						$.get(
							self.attr("href"),
							{"status" : status},
							function(data){
								loading.hide();
								if(data.status){
									self.html(status ? "禁用" : "启用");
									self.data(status);
								} else {
									$.thinkbox.error(data.info);
								}
							}, 
							"json"
						);
					}
				}
			});
			return false;
		});
	</script>
</body>
</html>